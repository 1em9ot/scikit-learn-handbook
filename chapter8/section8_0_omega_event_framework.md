# ΩとEの共通骨格（全分野共通フレームワーク）

このセクションは「イベントから確率統計の数値を書き下せる統一フレームワーク」を、既存の二値ラベル問題の文脈から一般化してまとめたもの。

---

## 0) 共通骨格（ベイズ以外でも同じ）

最短の言い換えはこれ：

- Ω：登場人物（状態・観測・抽出結果・順序）を全部並べる箱
- E：問われている条件/出来事（部分集合）
- 差し替え：Eを問題ごとに入れ替えるだけで同型処理
- 分解：和（分割）か積（段階）かを決める
- CBT：重み付きの比（A,B または m）に圧縮

この骨格が刺さるのは「観測・抽出・判定・制約をイベントとして扱える問題」全部。

---

## 1) “二値ラベル系”以外にも効く（ラベルが増えても同じ）

「P と 1−P」じゃなくて「オールオアナッシング（0/1）」でも同じ。むしろ 0/1 はイベント設計と相性が良い。

- 0/1（指示変数）で書ける問題は、ほぼ全部
  - E：{I=1} や {I=0} の組み合わせ（∩）
  - 和：場合分け（∪、または Σ）
  - 積：段階（∩を条件側に押し込む）

二値に限らず、ラベルが3つ以上でも「分母が Σ になるだけ」で骨格は同じ。

---

## 2) 具体的にどの分野に効くか（パターン別）

### A. 検査・判定・分類（ベイズの親戚）

- 医療検査を2回/3回、スクリーニング→精密検査
- spam判定、故障診断、異常検知
- 重要なのは「状態D（真）」と「観測R（結果）」の分離
- 差し替え：E＝{陽}, {陽陽}, {陰陽}…を入れ替えるだけ

### B. 抽出・サンプリング（非復元抽出、層化、検閲）

- 非復元抽出（超幾何、有限母集団補正）
- 層化抽出（層ごとのΩ、Eを層で差し替え）
- 差し替え：E＝{成功k個}、{特定の構成} など
- 二値じゃなくても指示変数で統一できる

### C. カウント・順列組合せ（“数え上げ→確率”の核）

- サイコロ/カード/並べ方/重複ありなし
- 「確率」は最後に割るだけで、まずはΩを定義して |E|/|Ω| へ
- 差し替え：E＝条件を満たす並び、条件を満たす集合

### D. 条件付き期待値・分散（分割と共分散）

- Eを「条件の集合」として分割し、期待値や分散を組み立てる
- 非独立（共分散≠0）が出る場面でも、
  - まずΩで登場人物を確定
  - 次にEで“どの組が同時に起きるか”を確定
  - それを ΣVar + 2ΣCov の型に落とす
- 差し替え：E＝{i=j}, {i≠j}, {同じ層}…みたいな局所条件

### E. 確率過程・逐次観測（漸化式が真価を発揮）

- マルコフ連鎖、更新、フィルタ（状態推定）
- ここは「q_i 更新」「L_i 当てはまり」が直撃で刺さる
- 差し替え：E_{1:i}＝観測列、条件は過去を含む

---

## 3) “P と 1−P”じゃなくて「オールオアナッシング」問題への接続

「Pと1−Pじゃない」問題は、だいたいこう：

- 確率値を直接持たず、指示変数 I∈{0,1} で持つ
- 目的が P(I=1) ではなく、
  - E[I], Var(I), Var(ΣI) など
- あるいは「成功/失敗」だけじゃなく構成が複数（k個成功等）

ここでも骨格は同じ：

- Ω：抽出結果や並びを含む結果空間
- E：I=1 となる条件（部分集合）
- P(E) から E[I]=P(E) に落ちる（0/1の利点）

---

## 4) “次に何をすればいいか”の目安（最短合格向け）

ベイズの骨格を本当に武器化するなら、次はこの順が最短：

1. 数え上げ型（|E|/|Ω|） を5問
   - ΩとEの設計が一番鍛えられる
2. 非復元抽出（共分散補正 or FPC） を5問
   - “独立じゃない”を E と Cov で処理する練習
3. 逐次観測（更新式） を3問
   - q_i / L_i の「差し替え」が完全に反射化する

ここまでやると「Ω→E差し替え→和/積→圧縮」が分野横断で固定される。

---

必要なら、「オールオアナッシング」系の問題文をそのまま提示すれば、本文中の分類に基づきタグ付けを行い、ΩとEの定義を最短で生成します。これにより「差し替え点」が確定するため、以降は同種の問題を高速に処理できます。
