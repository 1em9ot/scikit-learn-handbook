<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AR(1) プロセス解説</title>
    <style>
        @font-face {
            font-family: 'IPAexGothic';
            src: url('fonts/ipaexg.ttf') format('truetype');
        }
        body {
            font-family: 'IPAexGothic', sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        img { max-width: 100%; height: auto; border: 1px solid #ddd; margin-bottom: 10px; display: block; margin-left: auto; margin-right: auto;}
        code { background: #f4f4f4; padding: 2px 5px; border-radius: 3px; }
        .result-box { background: #eef; padding: 15px; border-radius: 5px; margin-top: 20px; }
        h2 { border-bottom: 2px solid #333; padding-bottom: 10px; margin-top: 30px; }
        h3 { margin-top: 25px; border-bottom: 1px solid #eee; padding-bottom: 5px; color: #444; }
        ul { margin-bottom: 20px; }
        .math-block { text-align: center; margin: 15px 0; }
        .note { background-color: #fff3cd; border: 1px solid #ffeeba; padding: 15px; border-radius: 5px; margin-top: 20px; }
    </style>
    <!-- Removed vulnerable polyfill.io -->
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
    <h1>AR(1) プロセス解説</h1>

    <h2>PBT最短回答（問12–14）</h2>

    <h3>P（前提）</h3>
    <ul>
        <li><strong>AR(1)側:</strong> \( u_{t+1}=\alpha u_t+\varepsilon_{t+1},\ |\alpha|<1,\ \varepsilon_t\sim N(0,\sigma^2) \) （定常）<br>
        \( y_t=\mu+u_t, \quad \bar y_T=\frac1T\sum_{t=1}^T y_t \)</li>
        <li><strong>iid側:</strong> \( x_i\stackrel{iid}{\sim}N(\mu,\sigma_u^2),\ \bar x=\frac1{10}\sum_{i=1}^{10}x_i \)</li>
    </ul>

    <h3>B（要点）</h3>
    <ul>
        <li>AR(1)の <strong>PACF</strong> は <strong>lag1のみ非ゼロ</strong>（lag≥2は0）</li>
        <li>定常分散: \( \sigma_u^2=\mathrm{Var}(u_t)=\dfrac{\sigma^2}{1-\alpha^2} \)</li>
        <li>共分散: \( \mathrm{Cov}(y_i,y_j)=\mathrm{Cov}(u_i,u_j)=\sigma_u^2\alpha^{|i-j|} \) （\( \alpha>0 \) なら正）</li>
    </ul>
    <p>平均の分散:</p>
    <div class="math-block">
        $$ \mathrm{Var}(\bar y_T)=\frac{1}{T^2}\Big(T\sigma_u^2+2\sum_{h=1}^{T-1}(T-h)\sigma_u^2\alpha^h\Big) > \frac{\sigma_u^2}{T} $$
    </div>
    <p>（iidは \( \mathrm{Var}(\bar x)=\sigma_u^2/10 \)）</p>

    <!-- Correlation Matrix Graph Insertion -->
    <h4>参考：相関行列の可視化</h4>
    <p>共分散 \( \mathrm{Cov}(y_i,y_j) \) の構造を以下に示します。</p>
    <img src="ar_correlation_matrix.png" alt="AR(1) Correlation Matrix">

    <h3>T（結論）</h3>
    <ul>
        <li><strong>問12：②</strong> （PACFがlag1で打ち切り）</li>
        <li><strong>問13：②</strong> （\( \sigma_u^2=\sigma^2/0.99 \)）</li>
        <li><strong>問14：③</strong> （\( \alpha>0 \) で \( \mathrm{Var}(\bar y_{10})>\mathrm{Var}(\bar x) \) ⇒ 同精度には \( T>10 \) が必要）</li>
    </ul>

    <!-- Variance Ratio Graph Insertion -->
    <h4>参考：分散比のグラフ</h4>
    <p>同精度にするために必要な \( T \) の関係を以下に示します。</p>
    <img src="ar_variance_ratio.png" alt="Variance Ratio Graph">

    <div class="note">
        その違和感は正常で、この問14の \( x \) は <strong>モデルの部品じゃなくて「比較用の仮想データ」</strong>として置かれてる。
    </div>

    <hr>

    <h2>この問題の3役</h2>

    <h3>\( u_t \)：ノイズ過程（潜在）</h3>
    <ul>
        <li>平均0のゆらぎ</li>
        <li>AR(1)で時間相関あり
            $$ u_{t+1}=\alpha u_t+\varepsilon_{t+1} $$
        </li>
        <li>定常なら \( \mathrm{Var}(u_t)=\sigma_u^2 \)</li>
    </ul>

    <h3>\( y_t \)：観測値（\( \mu \) の周りに \( u_t \) が乗る）</h3>
    <div class="math-block">
        $$ y_t=\mu+u_t $$
    </div>
    <ul>
        <li>1点だけ見れば \( y_t\sim N(\mu,\sigma_u^2) \)</li>
        <li>ただし \( t \) が違うと相関あり
            $$ \mathrm{Cov}(y_i,y_j)=\sigma_u^2\alpha^{|i-j|} $$
        </li>
    </ul>

    <h3>\( x_i \)：<strong>比較ベンチマーク（仮想の iid サンプル）</strong></h3>
    <div class="math-block">
        $$ x_i \stackrel{iid}{\sim} N(\mu,\sigma_u^2) $$
    </div>
    <ul>
        <li><strong>「各点の分散を \( y_t \) と同じ \( \sigma_u^2 \) に揃えた上で、相関だけ消した世界」</strong></li>
        <li>だから \( x \) は \( y \) から生成されるわけではなく、<strong>“もし独立に10回観測できたら”</strong>の基準線</li>
    </ul>

    <hr>

    <h2>なぜ \( \sigma^2 \) じゃなく \( \sigma_u^2 \) を使うのか</h2>
    <p>\( \sigma^2 \) は \( \varepsilon_t \) の分散で、\( u_t \) の分散ではない。<br>
    定常 AR(1) では</p>
    <div class="math-block">
        $$ \sigma_u^2=\frac{\sigma^2}{1-\alpha^2} $$
    </div>
    <p>なので、<strong>\( y_t \) の1点分布の分散は \( \sigma_u^2 \)</strong>。<br>
    比較を公平にするため、\( x_i \) も同じ分散にしてる。</p>

    <hr>

    <h2>直感の最短まとめ</h2>
    <ul>
        <li><strong>\( y \)</strong>：同じ情報を“近い時刻で繰り返し見てしまう” → 実質サンプル数が減る</li>
        <li><strong>\( x \)</strong>：同じ分散の情報を“独立に10回”見れる → 実質サンプル数=10</li>
    </ul>

    <hr>

    <h2>例外：\( \alpha=0 \) のときだけ「気持ち悪さ」が消える</h2>
    <p>\( \alpha=0 \) なら \( u_t=\varepsilon_t \) で iid になり、\( y_t \) も iid。<br>
    このときは \( x \) と \( y \) が「同じ世界」になる（依存構造まで一致）。</p>

    <p style="margin-top: 30px; font-size: 0.9em; color: #666;">
        必要なら、\( x_i \) を「\( y_t \) を間引いて独立っぽくしたもの（\( t_i \) を十分離す）」と解釈すると現実感が出る。
    </p>

    <p><a href="ar_example.ipynb">Jupyter Notebook をダウンロード</a></p>
</body>
</html>
